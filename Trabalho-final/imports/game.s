.include "macros.s"

.data

.include "../sprites/bin/fase1.s"
display: .word 0xff000000
map_positions: .byte 0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x11,0x01,0x01,0x01,0x01,0x01,0x11,0x01,0x01,0x01,0x01,0x01,0x11,0x01,0x01,0x01,0x01,0x01,0x11,0x01,0x01,0x01,0x01,0x01,0x11,0x01,0x01,0x01,0x01,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08

map_ladder: .byte 0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x02,0x02,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x02,0x02,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08

.text

	jal PRINT_BG
	jal INIT_MARIO
	j MAINLOOP

PRINT_BG:
	# printa fundo
	la t0,display
	lw s0,0(t0)
	li t0,76800
	la s1,fase1
	addi s1,s1,8
	FORF:
		beqz t0,FIMFORF
		lb t2,0(s1)
		sb t2,0(s0)
		addi s0,s0,1
		addi s1,s1,1
		addi t0,t0,-1
		j FORF
	FIMFORF:
		ret
		
# anotacao temporaria das teclas
# tecla 109 = M (sair)
# tecla 100 = D
# tecla 97 = A
# tecla 119 = W
# tecla 115 = S
# tecla 32 = espaco
# fim anotacao temporaria
MAINLOOP: # loop de jogo, verificar se tecla esta pressionada
	jal KEYBIND
	beqz a0,SEMKEY # se nenhuma tecla, faz nada
		li t0,109
		beq a0,t0,FIM # se tecla == M, sair
	
		li t0,100
		beq a0,t0,MOVE_MARIO_DIREITA
	
		li t0,97
		beq a0,t0,MOVE_MARIO_ESQUERDA
	
		li t0,32
		beq a0,t0,MARIO_PULO_UP
		
		li t0,119
		beq a0,t0,MOVE_MARIO_CIMA
		
		li t0,115
		beq a0,t0,MOVE_MARIO_BAIXO
		
	SEMKEY:
		j MAINLOOP

FIM:
	li a7,10
	ecall
	
.include "common.s"
.include "mario.s"
